# Upbit Trading Bot
ATR 기반의 변동성 필터링, 돌파 신호 감지로 거래 기회를 포착한다.

```bash
1. 변동성기준통과: 각 종목의 ATR(평균 실제 범위)을 최신 가격과 비교하여 계산한 비율이 설정된 임계값(0.015) 이상인 경우, 해당 종목이 ‘변동성이 높음’으로 판단되어 필터링을 통과했음.

2. n개 이벤트 감지: 최근 일정 기간(100개 캔들) 동안 각 캔들의 가격 변화율(pct_change)을 계산하여, 미리 설정한 임계값(0.005)을 초과하는 변동이 발생한 횟수를 기록. 이걸로 지원선/저항선 판단 진행.

3. 특별한 신호 없음: HOLD, 돌파 신호(현재 가격이 최근 이벤트에서 산출한 저항선 또는 지원선을 넘거나 하회하는 경우)가 감지되지 않았음

4. 지원선/저항선 판단방법: 
- 이벤트는 각 캔들의 가격 변화율이 사전에 정의된 임계값(0.005)을 초과할 때 기록된다. 각 이벤트에서 해당 시점의 종가(가격)를 추출함.
- 선택된 이벤트들의 가격 중 최저가를 지원선으로 간주, 선택된 이벤트들의 가격 중 최고가를 저항선으로 간주한다. 
- 현재 가격이 저항선보다 높으면 가격이 저항선을 돌파한 것으로 판단하여 BUY 신호를 발생.

```

## 주요 기능

- **티커 선정**  
  - 업비트의 KRW 마켓에서 상위 50개 티커를 조회한다.

- **변동성 필터링**  
  - 각 티커의 ATR(평균 실제 범위)을 계산한다.  
  - ATR/현재가 비율이 0.015 이상인 종목만 선택한다.

- **돌파 신호 감지**  
  - 최근 100개 캔들의 가격 변화율(pct_change)을 계산하여 이벤트를 감지한다.  
  - 이벤트 임계값을 0.005로 설정하여 민감하게 가격 변화를 포착한다.  
  - 최근 5개의 이벤트를 기준으로 지원선(최저가)과 저항선(최고가)을 산출한다.  
    - 현재가가 저항선을 초과하면 **BUY** 신호를 발생시킨다.  
    - 현재가가 지원선 아래로 하락하면 **SELL** 신호를 발생시킨다.  
    - 그 외에는 **HOLD** 신호를 유지한다.

- **포트폴리오 관리**  
  - 포트폴리오에 보유한 종목 수가 5개 미만일 경우, BUY 신호가 발생한 종목을 신규 진입시킨다.  
  - 보유 종목이 10개를 초과하면, 수익률이 가장 낮은 종목을 매도하여 포트폴리오를 정리한다.  
  - 보유 중인 종목은 다음 조건에 따라 매도한다:
    - **트레일링 스탑**: 진입가 대비 3% 이상 하락하면 매도한다.
    - **목표 수익률 도달**: (현재가 - 진입가)/진입가가 ATR 기준 수익률 이상이면 매도한다.
    - **반전 신호**: 돌파 신호 판단에서 SELL 신호가 발생하면 매도한다.

- **실시간 실행**  
  - 1분 간격으로 위의 과정을 반복하며, 각 단계의 주요 이벤트와 상태 변화를 로깅한다.

## 로직 요약

1. **데이터 수집 및 티커 선정**  
   - 업비트에서 상위 50개 티커를 조회한다.

2. **변동성 평가**  
   - 각 티커에 대해 1시간봉 기준 ATR을 계산한다.  
   - ATR/현재가 비율이 0.015 이상인 종목만 필터링한다.

3. **거래 신호 생성**  
   - 최근 100개 캔들의 가격 변화율을 계산하여 이벤트를 감지한다 (임계값 0.005 사용).  
   - 최근 5개 이벤트를 기반으로 지원선과 저항선을 산출한다.  
   - 현재 가격이 저항선을 초과하면 **BUY**, 지원선 이하이면 **SELL**, 그 외에는 **HOLD** 신호를 발생시킨다.

4. **포트폴리오 관리 및 실행**  
   - 포트폴리오가 5개 미만일 경우, BUY 신호가 발생한 종목을 신규 진입시킨다.  
   - 트레일링 스탑(진입가 대비 3% 하락), 목표 수익률 도달, 또는 SELL 신호 발생 시 매도한다.  
   - 보유 종목이 10개를 초과하면 수익률이 낮은 종목을 매도한다.

5. **실시간 반복**  
   - 1분마다 전체 과정을 재검토하며, 로그에 모든 활동을 기록한다.

## 기록
- 가격변화율, ATR 비율 조정필요.
